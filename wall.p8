pico-8 cartridge // http://www.pico-8.com
version 18
__lua__


function _init()

 we = {}
 mo = {}
 fc = {}

 we.x = 10
 we.y = 10
 we.flip = false
 
 mo.x = 100
 mo.y = 10
 mo.flip = false
 
 fc_added = 0
 fc_cleaned = 0
end 

function _update()
 move_guy(we, 0)
 move_guy(mo, 1) 
 
 add_fc()
 clean_fc()
end

function _draw()
 cls()

 for c in all(fc) do
  spr(c.sprite, c.x*8, c.y*8) 
 end

 spr(9, we.x, we.y, 2, 2, we.flip)
 spr(7, mo.x, mo.y, 2, 2, mo.flip)

 print(fc_added - fc_cleaned, 0, 0)
end



-->8
-- foreign contaminant

function add_fc()
 tx = flr(we.x / 8) + 1
 ty = flr(we.y / 8) + 2
 
 if (get_fc(tx, ty) == nil) then
	 c = {}
	 c.x = tx
	 c.y = ty
	 --choice = {5,6,21,22,37}
	 --c.sprite = choice[flr(rnd(5))+1]
  c.sprite = 37
  add(fc,c)
  fc_added += 1
 end
end

function clean_fc()
 tx = flr(mo.x / 8) + 1
 ty = flr(mo.y / 8) + 2

 c = get_fc(tx, ty)
 if (c != nil) then
  del(fc, c)
  fc_cleaned += 1
 end
end

function get_fc(x,y)
 for c in all(fc) do
  if (c.x == x and c.y == y) then
   return c
  end
 end
 
 return nil
end
-->8
-- wall-e and mo common

function move_guy(guy, p)
 if (btn(0,p)) then
 	guy.x-=1
 	guy.flip = true
 end
 if (btn(1,p)) then
  guy.x+=1
  guy.flip = false
 end
 if (btn(2,p)) guy.y-=1
 if (btn(3,p)) guy.y+=1

 if (guy.x < 0) guy.x = 0
 if (guy.x > 128-16) guy.x = 128-16
 if (guy.y < 0) guy.y = 0
 if (guy.y > 128-16) guy.y = 128-16
end
__gfx__
00000000000000000050500000055500005550000400050000450040000000000000000000444499444990000000000000000000000000000000000000000000
00000000000000000505050000050000000050005004004005004005000000888000000000484955949559000000000000000000000000000000000000000000
00700700000000000555550000050000000050000040505000045404000777777770000000048955949559000000000000000000000000000000000000000000
00077000044545400005000000454454454454000500040005405050007757777777000000004499444990000000000000000000000000000000000000000000
00077000040555400999990000449444944444004005050004004004007775777777000000000008400000000000000000000000000000000000000000000000
00700700044545400999990000444554455445000540400000540400007777777777700000000000840000000000000000000000000000000000000000000000
00000000000000000040400000544554455444000400040000400050000770000000700000009999999999000000000000000000000000000000000000000000
00000000000000000040400000449555555494004005405004005004000070aa0aa0700000099444444495650000000000000000000000000000000000000000
00040000000000000000000000444555555454000040500000040400000070000000700000994488855555550000000000000000000000000000000000000000
00404000000000000000000000444554455444005450040000400050000007777777000000944888855595650000000000000000000000000000000000000000
04000400000000000000000000494554455444005004004004505004000770777777000000944444444495650000000000000000000000000000000000000000
40000040000000000000000000444444944449000040500000040400000777111111100000945044444499000000000000000000000000000000000000000000
000000000000000000000000004454444444540004000400005000500005751cccccc10000956504444999000000000000000000000000000000000000000000
00000000000000000000000000000000000000004505005004004005000750011111110000565650999999000000000000000000000000000000000000000000
00000000000000000000000000000000000000000040400000540504000077777770000005696965050650000000000000000000000000000000000000000000
00000000000000000000000000000000000000000450040000400040000000555000000056555556505565000000000000000000000000000000000000000000
00000000000000000000000000000000000000000400040000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004004004000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000400040000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004004004000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000040400000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000400040000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000004004004000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
